<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PotPan - Đăng nhập & Đăng ký</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand:#ff6967;
      --brand-600:#ff534e;
      --surface:#ffffff;
      --surface-veil: rgba(255,255,255,.94);
      --shadow:0 8px 30px rgba(0,0,0,.12);
      --radius:20px;
      --border:#e9e9e9;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:'Roboto',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:#222;
      background:#ff6967;
      background-size:cover;
      background-position:center;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    /* ===== Layout wrapper (desktop/tablet: 2 cột, mobile: 1 cột) ===== */
    .container{
      display:grid;
      grid-template-columns: 1fr 1fr;         /* desktop default */
      width: min(100%, 980px);
      min-height: 560px;
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .container:focus-within{ box-shadow: 0 12px 36px rgba(0,0,0,.16); }

    .img-box{
      background:url('../assets/login-bg.jpg') center/cover no-repeat;
      min-height: 560px;
    }

    .form-wrapper{
      padding: 40px 40px 32px;
      display:flex;
      flex-direction:column;
      gap: 16px;
    }

    .header{
      display:flex; align-items:center; gap:14px; justify-content:center; margin-top:4px;
    }
    .header img{ width:82px; height:82px; transition: transform .25s ease; }
    .header img:hover{ transform: scale(1.06); }
    .header h1{ font-size:44px; color:var(--brand); margin:0; }

    .form-container{
      position:relative;
      flex:1;
      overflow:hidden;
      margin-top:8px;
    }
    .form-box{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      padding: 8px 0;
      opacity:0; pointer-events:none; transform: translateX(100%);
      transition: transform .5s ease, opacity .4s ease;
    }
    #signinBox{ transform: translateX(0); opacity:1; pointer-events:auto; z-index:2; }
    .signup-active #signinBox{ transform: translateX(-100%); opacity:0; pointer-events:none; }
    .signup-active #signupBox{ transform: translateX(0); opacity:1; pointer-events:auto; z-index:2; }

    form{ width:100%; max-width: 460px; display:flex; flex-direction:column; gap:18px; }

    .input-box{ display:flex; flex-direction:column; gap:8px; }
    label{ font-size:14px; color:#555; }
    input{
      width:100%;
      padding:14px 16px;
      border:1.5px solid var(--border);
      border-radius:10px;
      font-size:16px; /* iOS: chống auto-zoom */
      transition: border-color .2s ease, box-shadow .2s ease;
      background:#fff;
    }
    input:focus{
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(255,105,103,.2);
    }

    .pw-row{ position:relative; }
    .toggle-pw{
      position:absolute; right:10px; top:67%; transform:translateY(-50%);
      border:none; background:transparent; cursor:pointer; font-size:14px; color:#666; padding:6px 8px; border-radius:8px;
    }
    .toggle-pw:focus{ outline:none; box-shadow:0 0 0 2px rgba(255,105,103,.35); }

    .btn{
      background:var(--brand);
      color:#fff; border:none; border-radius:10px;
      padding:14px 16px; font-weight:700; font-size:16px;
      cursor:pointer; transition: background .2s ease, transform .06s ease;
    }
    .btn:hover{ background:var(--brand-600); }
    .btn:active{ transform: translateY(1px); }

    .options{
      margin-top: -6px; text-align:right; font-size:14px;
    }
    .options a{ color:var(--brand); text-decoration:none; font-weight:600; }
    .options a:hover{ text-decoration:underline; }

    .toggle-link{ text-align:center; font-size:15px; }
    .toggle-link a{ color:var(--brand); font-weight:700; text-decoration:none; }
    .toggle-link a:hover{ text-decoration:underline; }

    /* ===== Breakpoints ===== */

    /* Tablet / iPad (481–1024px) */
    @media (max-width: 1024px) and (min-width: 481px){
      .container{
        width: min(100%, 860px);
        grid-template-columns: 1.1fr 1fr;  /* ảnh hơi rộng để cân */
        min-height: 540px;
      }
      .img-box{ min-height: 540px; }
      .form-wrapper{ padding: 32px 32px 24px; }
      .header img{ width:72px; height:72px; }
      .header h1{ font-size:38px; }
      form{ max-width: 420px; }
      input, .btn{ padding: 13px 15px; font-size:16px; }
    }

    /* Mobile ≤ 480px */
    @media (max-width: 480px){
      body{
        padding: 18px;
        background: #ff6967 url('meal-logo.jpg') center/cover no-repeat fixed;
      }
      .container{
        grid-template-columns: 1fr;    /* 1 cột */
        width: 100%;
        max-width: 420px;
        background: var(--surface-veil);
        backdrop-filter: blur(10px);
        min-height: auto;
      }
      .img-box{ display:none; }
      .form-wrapper{ padding: 26px 18px 20px; }
      .header{ margin-top:0; }
      .header img{ width:58px; height:58px; }
      .header h1{ font-size:28px; }
      .form-container{ margin-top:0; min-height: 360px; }
      form{ max-width: 100%; padding: 2px; }
      input, .btn{ padding: 12px 14px; font-size:16px; }
      .toggle-link{ font-size:14px; }
      .options{ font-size:13px; }
    }

    /* Desktop lớn (≥ 1440px) – phóng nhẹ */
    @media (min-width: 1440px){
      .container{ transform: scale(1.02); }
    }

    /* Giảm chuyển động nếu người dùng chọn */
    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; }
    }
    
  </style>
</head>
<body>
  <div class="container" id="container">
    <div class="img-box" aria-hidden="true"></div>

    <div class="form-wrapper">
      <div class="header">
        <img src="../assets/home-page/logo.svg" alt="PotPan logo" />
        <h1>PotPan</h1>
      </div>

      <div class="form-container">
        <!-- Đăng nhập -->
        <div class="form-box" id="signinBox">
          <form id="signinForm" novalidate>
            <div class="input-box">
              <label for="signinEmail">Email</label>
              <input id="signinEmail" name="email" type="email" placeholder="Email" inputmode="email" autocomplete="email" required>
            </div>
            <div class="input-box pw-row">
              <label for="signinPassword">Mật khẩu</label>
              <input id="signinPassword" name="password" type="password" placeholder="Mật khẩu" autocomplete="current-password" required minlength="6">
              <button class="toggle-pw" type="button" aria-label="Hiện/ẩn mật khẩu" data-target="signinPassword">Hiện</button>
            </div>
            <button class="btn" type="submit">Đăng nhập</button>

            <div class="options">
              <a href="#">Quên mật khẩu?</a>
            </div>

            <div class="toggle-link">
              Bạn chưa có tài khoản? <a href="#" id="signupLink">Đăng ký ngay</a>
            </div>
          </form>
        </div>

        <!-- Đăng ký -->
        <div class="form-box" id="signupBox">
          <form id="signupForm" novalidate>
            <div class="input-box">
              <label for="fullName">Họ và tên</label>
              <input id="fullName" name="name" type="text" placeholder="Họ và tên" autocomplete="name" required>
            </div>
            <div class="input-box">
              <label for="signupEmail">Email</label>
              <input id="signupEmail" name="email" type="email" placeholder="Email" inputmode="email" autocomplete="email" required>
            </div>
            <div class="input-box pw-row">
              <label for="signupPassword">Mật khẩu</label>
              <input id="signupPassword" name="password" type="password" placeholder="Mật khẩu (≥ 6 ký tự)" autocomplete="new-password" required minlength="6">
              <button class="toggle-pw" type="button" aria-label="Hiện/ẩn mật khẩu" data-target="signupPassword">Hiện</button>
            </div>
            <button class="btn" type="submit">Đăng ký</button>

            <div class="toggle-link">
              Đã có tài khoản? <a href="#" id="signinLink">Đăng nhập ngay</a>
            </div>
          </form>
        </div>
      </div><!-- /form-container -->
    </div><!-- /form-wrapper -->
  </div><!-- /container -->

  <script>
    // Toggle giữa Signin/Signup
    const root = document.getElementById('container');
    const signupLink = document.getElementById('signupLink');
    const signinLink = document.getElementById('signinLink');

    signupLink.addEventListener('click', (e)=>{ e.preventDefault(); root.classList.add('signup-active'); });
    signinLink.addEventListener('click', (e)=>{ e.preventDefault(); root.classList.remove('signup-active'); });

    // Hiện/ẩn mật khẩu
    document.querySelectorAll('.toggle-pw').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.dataset.target;
        const inp = document.getElementById(id);
        const isPw = inp.type === 'password';
        inp.type = isPw ? 'text' : 'password';
        btn.textContent = isPw ? 'Ẩn' : 'Hiện';
      });
    });

    // Validate nhẹ (tránh submit form trống)
    const requireValid = (form) => {
      form.addEventListener('submit', (e)=>{
        if(!form.checkValidity()){
          e.preventDefault();
          form.reportValidity();
        }
      });
    };
    requireValid(document.getElementById('signinForm'));
    requireValid(document.getElementById('signupForm'));
        // ======= XỬ LÝ ĐĂNG KÝ / ĐĂNG NHẬP =======

    // Hàm lưu tài khoản mới vào localStorage
    function saveUser(email, name, password){
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      // Kiểm tra trùng email
      if(users.some(u => u.email === email)){
        alert('Email này đã được đăng ký!');
        return false;
      }
      users.push({ email, name, password });
      localStorage.setItem('users', JSON.stringify(users));
      alert('Đăng ký thành công! Hãy đăng nhập.');
      root.classList.remove('signup-active');
      return true;
    }

    // Hàm kiểm tra đăng nhập
    function checkLogin(email, password){
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.email === email && u.password === password);
      return user || null;
    }

    // Thêm phần tử hiển thị thông báo lỗi
    const errorMsg = document.createElement('p');
    errorMsg.style.color = '#FF6967';
    errorMsg.style.fontWeight = '500';
    errorMsg.style.fontFamily = 'Roboto, system-ui, sans-serif';
    errorMsg.style.fontSize = '15px';
    errorMsg.style.textAlign = 'center';
    errorMsg.style.marginTop = '-8px';
    errorMsg.style.display = 'none';
    document.querySelector('#signinForm .btn').insertAdjacentElement('afterend', errorMsg);

    // Xử lý đăng ký
    document.getElementById('signupForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const name = document.getElementById('fullName').value.trim();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value.trim();

      if(!name || !email || !password){ alert('Vui lòng nhập đủ thông tin.'); return; }
      if(password.length < 6){ alert('Mật khẩu phải có ít nhất 6 ký tự.'); return; }

      saveUser(email, name, password);
      document.getElementById('signupForm').reset();
    });

    // Xử lý đăng nhập
    document.getElementById('signinForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const email = document.getElementById('signinEmail').value.trim();
      const password = document.getElementById('signinPassword').value.trim();
      const user = checkLogin(email, password);

      if(user){
        // Lưu user hiện tại và chuyển trang
        localStorage.setItem('currentUser', JSON.stringify(user));
        window.location.href = '../pages/main/home.html'; // điều hướng sang trang Hồ sơ
      } else {
        errorMsg.textContent = 'Sai email hoặc mật khẩu. Vui lòng thử lại.';
        errorMsg.style.display = 'block';
      }
    });

  </script>
</body>
</html>

